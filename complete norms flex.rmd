---
title: "Dutch modality exclusivity norms (Bernabeu et al., 2017)"
output:
  flexdashboard::flex_dashboard:
    orientation: columns
    social: menu
    source_code: embed
runtime: shiny
---



<!-- CSS formatting: 'Info' page margins, columns, size of block quote -->

<style>

#section-info{
  padding: 27px 25px 35px 25px;
}

.column-left{
  float: left;
  width: 52%;
  text-align: justify;
}

.column-right{
  float: right;
  width: 40%;
  text-align: right;
}

blockquote {
    font-size: 14px;
}

</style>




```{r global, include = FALSE}

library(ltm)
library(lattice)
library(psych)
library(car)
library(doBy)
library(contrast)
library(pastecs)
library(scales)
library(ggplot2)
library(reshape)
library(arules)
library(plyr)
library(magrittr)
library(RColorBrewer)
library(Rmisc)
library(corpcor)
library(GPArotation)
library(ggplot2)
library(colorspace)
library(dplyr)
library(rlang)
library(gdata)
library(QuantPsyc)
library(MASS)
library(qpcR)
library(gtools)
library(Hmisc)
library(png)
library(grid)
library(ggrepel)
library(tibble)
library(curl)
library(leaflet)
library(RCurl)
library(Rcpp)
library(shiny)
library(scales)
library(rsconnect)
library(plotly)
library(flexdashboard)




# Perform analyses for PCA

# RELATION AMONG MODALITIES

# Below is a Principal Components Analysis (PCA) with plots. Firstly it is performed 
# on the Dutch norms, and then on Lynott and Connell's (2009, 2013) English norms 
# (leaving out gustatory and olfactory scores and words). 

all <- read.csv('https://raw.githubusercontent.com/pablobernabeu/Modality-exclusivity-norms-747-Dutch-English-replication/master/all.csv')
nrow(all)




# PROPERTIES

# Check conditions for a PCA

# matrix
prop <- all[all$cat == 'prop' & !is.na(all$word), c('Auditory', 'Haptic', 'Visual')]
nrow(prop)
prop_matrix <- cor(prop, use = 'complete.obs')
prop_matrix
round(prop_matrix, 2)
# POOR: correlations not apt for a PCA, with too many below .3

# now on the raw vars:
nrow(prop)
cortest.bartlett(prop)
# GOOD: Bartlett's test significant 

# KMO: Kaiser-Meyer-Olkin Measure of Sampling Adequacy
KMO(prop_matrix)
# Result: .56 = mediocre. PCA not strongly recommended. But we still do it
# because the purpose is graphical only.

# check determinant
det(prop_matrix)
# GOOD: > 0.00001

# start off with unrotated PCA
pc1_prop <- psych::principal(prop, nfactors = 3, rotate = "none")
pc1_prop
# RESULT: Only PC1, with eigenvalue > 1, should be extracted, 
# acc to Kaiser's criterion (Jolliffe's threshold of 0.7 way too lax; 
# Field, Miles, & Field, 2012)

# Unrotated: scree plot
plot(pc1_prop$values, type = "b")
# Result: one or two RCs should be extracted, converging with eigenvalues

# Now with varimax rotation, Kaiser-normalized (by default). 
# Always preferable because it captures explained variance best. 
# Compare eigenvalues w/ 1 & 2 factors

pc2_prop <- psych::principal(prop, nfactors = 2, rotate = "varimax", scores = TRUE)
pc2_prop
pc2_prop$loadings
# good to extract 2 factors, as they both explain quite the same variance,
# and both surpass 1 eigenvalue


pc2_prop$residual
pc2_prop$fit
pc2_prop$communality
# Results based on a Kaiser-normalizalized orthogonal (varimax) rotation
# (by default in psych::stats). Residuals OK: fewer than 50% have absolute 
# values > 0.05 (exactly 50% do).Model fit good, > .90. 
# Communalities good, all > .7 (av = .83). 

# subset and add PCs
props <- all[all$cat == 'prop' & !is.na(all$word), ]
nrow(props)
props <- cbind(props, pc2_prop$scores)
nrow(props)

# Extend initial of main modality into full word

levels(props$main)[levels(props$main) == 'a'] = 'Auditory'
levels(props$main)[levels(props$main) == 'h'] = 'Haptic'
levels(props$main)[levels(props$main) == 'v'] = 'Visual'

# Set two decimals

props$RC1 = round(props$RC1, 2)
props$RC2 = round(props$RC2, 2)
props$Auditory = round(props$Auditory, 2)
props$Haptic = round(props$Haptic, 2)
props$Visual = round(props$Visual, 2)
props$Perceptualstrength = round(props$Perceptualstrength, 2)
props$Exclusivity = round(props$Exclusivity, 2)

props$word = as.character(props$word)

# Replace NA word frequency with 0 to allow selection
props[is.na(props$freq_lg10WF_SUBTLEXNL), 'freq_lg10WF_SUBTLEXNL'] = 0

# Turn modality exclusivity into percentage
props$Exclusivity = props$Exclusivity * 100

colours = c('firebrick1', 'dodgerblue', 'forestgreen')





# CONCEPTS

# Check conditions for a PCA
# matrix
conc <- all[all$cat == 'conc' & !is.na(all$word), c('Auditory', 'Haptic', 'Visual')]
nrow(conc)
conc_matrix <- cor(conc, use = 'complete.obs')
conc_matrix
round(conc_matrix, 2)
# POOR: correlations not apt for a PCA, with too many below .3

# now on the raw data:
nrow(conc)
cortest.bartlett(conc)
# GOOD: Bartlett's test significant 

# KMO: Kaiser-Meyer-Olkin Measure of Sampling Adequacy
KMO(conc_matrix)
# Result: .49 = poor. PCA not strongly recommended. But we still do it
# because the purpose is graphical really.

# check determinant
det(conc_matrix)
# GOOD: > 0.00001

# start off with unrotated PCA
pc1_conc <- psych::principal(conc, nfactors = 3, rotate = "none")
pc1_conc
# RESULT good: PC1 and PC2, with eigenvalue > 1, should be extracted, 
# acc to Kaiser's criterion (Jolliffe's threshold of 0.7 way too lax; 
# Field, Miles, & Field, 2012)

# Unrotated: scree plot
plot(pc1_conc$values, type = "b")
# Result: with no point of inflexion along the y axis, two PCs would obtain.

# Now with varimax rotation, Kaiser-normalized (by default):
# Always preferable because it captures explained variance best. 
# Compare eigenvalues w/ 1 & 2 Principal Components

pc2_conc <- psych::principal(conc, nfactors = 2, rotate = "varimax", scores = TRUE)
pc2_conc
pc2_conc$loadings

# good to extract 2 Principal Components, as they both explain quite the same variance, 
# and both surpass 1 eigenvalue

pc2_conc$residual
pc2_conc$fit
pc2_conc$communality
# Results based on a Kaiser-normalizalized orthogonal (varimax) rotation
# (by default in psych::stats). Residuals bad: over 50% have absolute 
# values > 0.05. Model fit good, > .90. Communalities good, all > .7 (av = .82). 

# subset and add PCs
concs <- all[all$cat == 'conc' & !is.na(all$word), ]
nrow(concs)
concs <- cbind(concs, pc2_conc$scores)
nrow(concs)

# Extend initial of main modality into full word

levels(concs$main)[levels(concs$main) == 'a'] = 'Auditory'
levels(concs$main)[levels(concs$main) == 'h'] = 'Haptic'
levels(concs$main)[levels(concs$main) == 'v'] = 'Visual'

# Set two decimals

concs$RC1 = round(concs$RC1, 2)
concs$RC2 = round(concs$RC2, 2)
concs$Auditory = round(concs$Auditory, 2)
concs$Haptic = round(concs$Haptic, 2)
concs$Visual = round(concs$Visual, 2)
concs$Perceptualstrength = round(concs$Perceptualstrength, 2)
concs$Exclusivity = round(concs$Exclusivity, 2)

concs$word = as.character(concs$word)

# Replace NA word frequency with 0 to allow selection
concs[is.na(concs$freq_lg10WF_SUBTLEXNL), 'freq_lg10WF_SUBTLEXNL'] = 0

# Turn modality exclusivity into percentage
concs$Exclusivity = concs$Exclusivity * 100

colours = c('firebrick1', 'dodgerblue', 'forestgreen')

```




Properties
=======================================================================

Column {.sidebar}
-----------------------------------------------------------------------

<div style = "text-align: justify"> <font color = "#959494">

Tabs may be switched above. Zooming may be done on the plot..

</div> </font>


```{r}

# Highlight words

selectizeInput("highlighted_properties", label = "Highlighted words", choices = sort(props$word), multiple = TRUE) 



# Modality exclusivity

sliderInput("properties_Exclusivity", "Modality exclusivity (%)", min = 0, max = 100, value = c(0, 100))


# Perceptual strength

sliderInput("properties_Strength", "Perceptual strength", min = 0, max = 5, value = c(0, 5), step = 0.3)


# Auditory

sliderInput("properties_Auditory", "Auditory rating", min = 0, max = 5, value = c(0, 5), step = 0.3)


# Haptic

sliderInput("properties_Haptic", "Haptic rating", min = 0, max = 5, value = c(0, 5), step = 0.3)


# Visual

sliderInput("properties_Visual", "Visual rating", min = 0, max = 5, value = c(0, 5), step = 0.3)


# Word frequency (Lg10WF-SUBTLEXNL)

sliderInput("properties_Freq", "Word frequency", min = 0, max = 5, value = c(0, 5), step = 0.3)

```

<span style = "font-size: 0.9em; text-align: justify""> <b> Exclusivity: </b> Range of the three modality ratings divided by the sum (Lynott & Connell, 2009). </span>

<span style = "font-size: 0.9em; text-align: justify""> <b> Strength: </b> Highest rating across modalities (Lynott & Connell, 2009). </span>

<span style = "font-size: 0.9em; text-align: justify""> <b> Word frequency: </b> Keuleers, Brysbaert, and New (2010). </span>


<center> <font color = "#959494">

[See Info tab](#section-info)

</center> </font>



Column
-----------------------------------------------------------------------

### 336 Property words (mainly adjectives)

```{r}

highlighted_properties = reactive(input$highlighted_properties)

selected_props = reactive({
	props[which(props$Exclusivity >= as.numeric(min(input$properties_Exclusivity)) &
		props$Exclusivity <= as.numeric(max(input$properties_Exclusivity)) &
		props$Perceptualstrength >= as.numeric(min(input$properties_Strength)) &
		props$Perceptualstrength <= as.numeric(max(input$properties_Strength)) &
		props$Auditory >= as.numeric(min(input$properties_Auditory)) & 
		props$Auditory <= as.numeric(max(input$properties_Auditory)) &
		props$Haptic >= as.numeric(min(input$properties_Haptic)) &
		props$Haptic <= as.numeric(max(input$properties_Haptic)) &
		props$Visual >= as.numeric(min(input$properties_Visual)) &
		props$Visual <= as.numeric(max(input$properties_Visual)) &
		props$freq_lg10WF_SUBTLEXNL >= as.numeric(min(input$properties_Freq)) &
		props$freq_lg10WF_SUBTLEXNL <= as.numeric(max(input$properties_Freq)) ) ,]
})



renderPlot({

 ggplotly(

  ggplot(selected_props(),
                    aes(RC1, RC2, color = main, label = as.character(word),
                        text = paste0( ' <b><span style="font-size:2em;">', capitalize(word), '</b></span> ',	# Html tags used for format
					 '<br></br> Main modality: <b>', main, ' ', '</b><br> Principal Component 1: <b>', RC1, ' ', 
					 '</br></b> Principal Component 2: <b>', RC2, ' ', '</b><br> Auditory: <b>', Auditory, ' ', 
					 '</b><br> Haptic: <b>', Haptic, ' ', '</b><br> Visual: <b>', Visual, ' ',
                               '</b><br> Perceptual strength: <b>', Perceptualstrength, ' ', '</b><br> Exclusivity: <b>', Exclusivity, '% ',
					 '</b><br> Word frequency (lg10WF-SUBTLEXNL): <b>', freq_lg10WF_SUBTLEXNL, '<b>', ' ' ) )) +
  geom_text(size = ifelse(selected_props()$word %in% highlighted_properties(), 7,
			    ifelse(is.null(highlighted_properties()), 3, 2.8)),
            fontface = ifelse(selected_props()$word %in% highlighted_properties(), 'bold', 'plain')) +
  scale_colour_manual(values = colours) +  ggtitle('Property words') + theme_bw() +
  labs(x = 'Varimax-rotated Principal Component 1', y = 'Varimax-rotated Principal Component 2') +
  guides(color = guide_legend(title = 'Main<br>modality')) +
  theme( plot.background = element_blank(), panel.grid.major = element_blank(),
         panel.grid.minor = element_blank(), panel.border = element_blank(),
         axis.line = element_line(color = 'black'),
         axis.title.x = element_text(colour = 'black', size = 11, margin = margin(15,15,0,15)),
         axis.title.y = element_text(colour = 'black', size = 11, margin = margin(0,15,15,15)),
         axis.text.x = element_text(size=12), axis.text.y  = element_text(size=12),
         plot.title = element_text(hjust = 0.5, size = 21, face = 'bold', margin = margin(15,15,15,15)),
         legend.background = element_rect(size = 2), legend.position = 'right',
	   legend.title = element_text(size = 16, face = 'bold'),
         legend.text = element_text(colour = colours, size = 13, face = 'bold')
  ),

  tooltip = 'text'
 )

})

```





Concepts
=======================================================================

Column {.sidebar}
-----------------------------------------------------------------------

<div style = "text-align: justify"> <font color = "#959494">

Tabs may be switched above. Zooming may be done on the plot.

</div> </font>


```{r}

# Highlight words

selectizeInput("highlighted_concepts", label = "Highlighted words", choices = sort(concs$word), multiple = TRUE)


# Modality exclusivity

sliderInput("concepts_Exclusivity", "Modality exclusivity (%)", min = 0, max = 100, value = c(0, 100))


# Perceptual strength

sliderInput("concepts_Strength", "Perceptual strength", min = 0, max = 5, value = c(0, 5), step = 0.3)


# Auditory

sliderInput("concepts_Auditory", "Auditory rating", min = 0, max = 5, value = c(0, 5), step = 0.3)


# Haptic

sliderInput("concepts_Haptic", "Haptic rating", min = 0, max = 5, value = c(0, 5), step = 0.3)


# Visual

sliderInput("concepts_Visual", "Visual rating", min = 0, max = 5, value = c(0, 5), step = 0.3)


# Word frequency (Lg10WF-SUBTLEXNL)

sliderInput("concepts_Freq", "Word frequency", min = 0, max = 5, value = c(0, 5), step = 0.3)

```

<span style = "font-size: 0.9em; text-align: justify""> <b> Exclusivity: </b> Range of the three modality ratings divided by the sum (Lynott & Connell, 2009). </span>

<span style = "font-size: 0.9em; text-align: justify""> <b> Strength: </b> Highest rating across modalities (Lynott & Connell, 2009). </span>

<span style = "font-size: 0.9em; text-align: justify""> <b> Word frequency: </b> Keuleers, Brysbaert, and New (2010). </span>


<center> <font color = "#959494">

[See Info tab](#section-info)

</center> </font>




Column {data-width = 600}
-----------------------------------------------------------------------

### 411 Concept words (mainly nouns)

```{r}

highlighted_concepts = reactive(input$highlighted_concepts)

selected_concs = reactive({
	concs[which(concs$Exclusivity >= as.numeric(min(input$concepts_Exclusivity)) &
		concs$Exclusivity <= as.numeric(max(input$concepts_Exclusivity)) &
		concs$Perceptualstrength >= as.numeric(min(input$concepts_Strength)) &
		concs$Perceptualstrength <= as.numeric(max(input$concepts_Strength)) &
		concs$Auditory >= as.numeric(min(input$concepts_Auditory)) & 
		concs$Auditory <= as.numeric(max(input$concepts_Auditory)) &
		concs$Haptic >= as.numeric(min(input$concepts_Haptic)) &
		concs$Haptic <= as.numeric(max(input$concepts_Haptic)) &
		concs$Visual >= as.numeric(min(input$concepts_Visual)) &
		concs$Visual <= as.numeric(max(input$concepts_Visual)) &
		concs$freq_lg10WF_SUBTLEXNL >= as.numeric(min(input$concepts_Freq)) &
		concs$freq_lg10WF_SUBTLEXNL <= as.numeric(max(input$concepts_Freq)) ) ,]
})



renderPlot({

 ggplotly(

  ggplot(selected_concs(),
                    aes(RC1, RC2, color = main, label = as.character(word),
                        text = paste( '<b>', capitalize(word), '</b><br> Main modality:<b>', main,
                               '</b><br> Principal Component 1:<b>', RC1, '</b><br> Principal Component 2:<b>', RC2,
                               '</b><br> Auditory:<b>', Auditory, '</b><br> Haptic:<b>', Haptic, '</b><br> Visual:<b>', Visual,
                               '</b><br> Perceptual strength:<b>', Perceptualstrength, '</b><br> Exclusivity:<b>', Exclusivity,
					 '</b><br> Word frequency (lg10WF-SUBTLEXNL):<b>', freq_lg10WF_SUBTLEXNL, '<b>' ) )) +
  geom_text(size = ifelse(selected_concs()$word %in% highlighted_concepts(), 7, 3),
            fontface = ifelse(selected_concs()$word %in% highlighted_concepts(), 'bold', 'plain')) +
  scale_colour_manual(values = colours) +  ggtitle('Concept words') + theme_bw() +
  labs(x = 'Varimax-rotated Principal Component 1', y = 'Varimax-rotated Principal Component 2') +
  guides(color = guide_legend(title = 'Main<br>modality')) +
  theme( plot.background = element_blank(), panel.grid.major = element_blank(),
         panel.grid.minor = element_blank(), panel.border = element_blank(),
         axis.line = element_line(color = 'black'),
         axis.title.x = element_text(colour = 'black', size = 11, margin = margin(15,15,0,15)),
         axis.title.y = element_text(colour = 'black', size = 11, margin = margin(0,15,15,15)),
         axis.text.x = element_text(size=12), axis.text.y  = element_text(size=12),
         plot.title = element_text(hjust = 0.5, size = 21, face = 'bold', margin = margin(15,15,15,15)),
         legend.background = element_rect(size = 2), legend.position = 'right',
	   legend.title = element_text(size = 16, face = 'bold'),
         legend.text = element_text(colour = colours, size = 13, face = 'bold')
  ),

  tooltip = 'text'
 )

})

```




Info
=======================================================================

Column
-----------------------------------------------------------------------

<div class = "column-left">

These modality norms were created to facilitate research about language. They have been used in a [conceptual modality switch experiment](https://mindmodeling.org/cogsci2017/papers/0318/index.html). The results revealed that switches across trials with different primary modalities incurred measurable effects in semantic processing. In addition, several analyses on the norms are due to be reported in a forthcoming paper. All data and analysis code, as well as some further report, is [available here](https://osf.io/brkjw/wiki/home/).

The linguistic materials, and any others such as code, are available for re-use, provided acknowledgment of the following publication ([CC-By licence](https://creativecommons.org/licenses/by/4.0/)).

> Bernabeu, P., Willems, R. M., & Louwerse, M. M. (2017). Modality switch effects emerge early and increase throughout conceptual processing: Evidence from ERPs. In G. Gunzelmann, A. Howes, T. Tenbrink, & E. J. Davelaar (Eds.), *Proceedings of the 39th Annual Conference of the Cognitive Science Society* (pp. 1629-1634). Austin, TX: Cognitive Science Society.


#### Other references

Keuleers, E., Brysbaert, M. & New, B. (2010). SUBTLEX-NL: A new frequency measure for Dutch words based on film subtitles. *Behavior Research Methods, 42*, 3, 643-650.

Lynott, D., & Connell, L. (2009). Modality exclusivity norms for 423 object properties. *Behavior Research Methods, 41*, 2, 558-564.

Lynott, D., & Connell, L. (2013). Modality exclusivity norms for 400 nouns: The relationship between perceptual experience and surface word form. *Behavior Research Methods, 45*, 516-526.


### Contact

Pablo Bernabeu. Email: p.bernabeu@lancaster.ac.uk.

[Personal webpage](http://www.research.lancs.ac.uk/portal/en/people/pablo-de-juan-bernabeu)

</div>

<br><br/>


Column
-----------------------------------------------------------------------

<div class = "column-right">

Comparison with [Lynott and Connell's English norms](http://www.lancaster.ac.uk/staff/connelll/lab/norms.html), reanalysed with  three modalities instead of five. </br>

```{r fig.width = 5, fig.height = 5, echo = FALSE}

grid.raster(readPNG(getURLContent('https://raw.githubusercontent.com/pablobernabeu/Modality-exclusivity-norms-747-Dutch-English-replication/master/allfour_lowres.png')))

```

</div>

<br><br/>


